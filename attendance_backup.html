<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance Management - Placement Training System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
    <script>
        tailwind.config = {
            darkMode: ["class"],
            theme: {
                container: { center: true, padding: "2rem", screens: { "2xl": "1400px" } },
                extend: {
                    colors: {
                        border: "hsl(214 32% 91%)",
                        input: "hsl(214 32% 91%)",
                        ring: "hsl(222 47% 20%)",
                        background: "hsl(210 20% 98%)",
                        foreground: "hsl(222 47% 11%)",
                        primary: { DEFAULT: "hsl(222 47% 20%)", foreground: "hsl(210 40% 98%)" },
                        secondary: { DEFAULT: "hsl(180 45% 45%)", foreground: "hsl(0 0% 100%)" },
                        destructive: { DEFAULT: "hsl(0 84% 60%)", foreground: "hsl(210 40% 98%)" },
                        muted: { DEFAULT: "hsl(210 20% 94%)", foreground: "hsl(215 16% 47%)" },
                        accent: { DEFAULT: "hsl(38 92% 50%)", foreground: "hsl(222 47% 11%)" },
                        success: { DEFAULT: "hsl(152 69% 40%)", foreground: "hsl(0 0% 100%)" },
                        warning: { DEFAULT: "hsl(38 92% 50%)", foreground: "hsl(222 47% 11%)" },
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Plus Jakarta Sans', 'sans-serif'],
                    },
                },
            },
        }
    </script>
    <link rel="stylesheet" href="assets/css/styles.css">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body class="bg-background text-foreground min-h-screen flex flex-col">

    <!-- Header injected via main.js -->

    <main class="flex-1">
        <!-- Hero Section -->
        <section class="bg-gradient-hero py-16 lg:py-24">
            <div class="container">
                <div class="mx-auto max-w-3xl text-center">
                    <span class="mb-4 inline-block rounded-full bg-primary-foreground/10 px-4 py-1.5 text-sm font-medium text-primary-foreground backdrop-blur-sm">
                        Attendance Management
                    </span>
                    <h1 class="mb-4 font-display text-3xl font-bold text-primary-foreground sm:text-4xl lg:text-5xl">
                        Track Student Progress
                    </h1>
                    <p class="mb-8 text-lg text-primary-foreground/80">
                        Monitor attendance, manage leave requests, and ensure placement training compliance
                    </p>
                </div>
            </div>
        </section>

        <!-- Faculty View (Default) -->
        <div id="faculty-view" class="hidden">
            <!-- Quick Stats -->
            <section class="border-b border-border bg-card py-6">
                <div class="container">
                    <div class="grid grid-cols-2 gap-4 lg:grid-cols-4">
                        <div class="rounded-xl bg-muted/50 p-4 text-center">
                            <p id="total-students" class="text-2xl font-bold text-foreground">0</p>
                            <p class="text-sm text-muted-foreground">Total Students</p>
                        </div>
                        <div class="rounded-xl bg-muted/50 p-4 text-center">
                            <p id="present-today" class="text-2xl font-bold text-success">0</p>
                            <p class="text-sm text-muted-foreground">Present Today</p>
                        </div>
                        <div class="rounded-xl bg-muted/50 p-4 text-center">
                            <p id="absent-today" class="text-2xl font-bold text-destructive">0</p>
                            <p class="text-sm text-muted-foreground">Absent Today</p>
                        </div>
                        <div class="rounded-xl bg-muted/50 p-4 text-center">
                            <p id="pending-leaves" class="text-2xl font-bold text-warning">0</p>
                            <p class="text-sm text-muted-foreground">Pending Leaves</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Attendance Management -->
            <section class="py-12 lg:py-16">
                <div class="container">
                    <div class="grid gap-8 lg:grid-cols-3">
                        <!-- Add Students -->
                        <div class="lg:col-span-1">
                            <div class="rounded-xl border border-border bg-card shadow-card p-6">
                                <h2 class="mb-4 font-display text-lg font-semibold">Add Students</h2>
                                
                                <div class="space-y-4">
                                    <div>
                                        <label class="mb-2 block text-sm font-medium">Student Name</label>
                                        <input type="text" id="student-name" placeholder="Enter student name"
                                            class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50">
                                    </div>
                                    <button onclick="addStudent()"
                                        class="w-full inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 bg-primary text-primary-foreground hover:bg-primary/90">
                                        <i data-lucide="user-plus" class="mr-2 h-4 w-4"></i>
                                        Add Student
                                    </button>
                                </div>

                                <div class="mt-6 pt-6 border-t border-border">
                                    <h3 class="mb-3 font-semibold">Upload CSV File</h3>
                                    <input type="file" id="csv-upload" accept=".csv" onchange="uploadCSV(event)"
                                        class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50">
                                    <p class="mt-2 text-xs text-muted-foreground">
                                        CSV Format: One student name per row OR first column = name
                                    </p>
                                </div>
                            </div>

                            <!-- Leave Requests -->
                            <div class="mt-8 rounded-xl border border-border bg-card shadow-card p-6">
                                <h2 class="mb-4 font-display text-lg font-semibold">Leave Requests</h2>
                                <div id="leave-requests" class="space-y-3">
                                    <!-- Leave requests will be populated here -->
                                </div>
                            </div>
                        </div>

                        <!-- Attendance Table -->
                        <div class="lg:col-span-2">
                            <div class="rounded-xl border border-border bg-card shadow-card p-6">
                                <div class="mb-6 flex items-center justify-between">
                                    <h2 class="font-display text-lg font-semibold">Attendance - <span id="current-date"></span></h2>
                                    <div class="flex items-center gap-2">
                                        <button onclick="markAllPresent()"
                                            class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-9 px-3 bg-success text-success-foreground hover:bg-success/90">
                                            <i data-lucide="check-circle" class="mr-1 h-3 w-3"></i>
                                            All Present
                                        </button>
                                        <button onclick="saveAttendance()"
                                            class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-9 px-3 bg-primary text-primary-foreground hover:bg-primary/90">
                                            <i data-lucide="save" class="mr-1 h-3 w-3"></i>
                                            Save
                                        </button>
                                    </div>
                                </div>

                                <div class="overflow-x-auto">
                                    <table class="w-full">
                                        <thead>
                                            <tr class="border-b border-border">
                                                <th class="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-muted-foreground">Roll</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium uppercase tracking-wider text-muted-foreground">Name</th>
                                                <th class="px-4 py-3 text-center text-xs font-medium uppercase tracking-wider text-muted-foreground">Present</th>
                                                <th class="px-4 py-3 text-center text-xs font-medium uppercase tracking-wider text-muted-foreground">Absent</th>
                                                <th class="px-4 py-3 text-center text-xs font-medium uppercase tracking-wider text-muted-foreground">Attendance %</th>
                                            </tr>
                                        </thead>
                                        <tbody id="attendance-table-body" class="divide-y divide-border">
                                            <!-- Attendance rows will be populated here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Student View -->
        <div id="student-view" class="hidden">
            <section class="py-12 lg:py-16">
                <div class="container">
                    <div class="mx-auto max-w-2xl">
                        <!-- Student Attendance Card -->
                        <div class="rounded-xl border border-border bg-card shadow-card overflow-hidden">
                            <div class="bg-gradient-to-r from-primary to-secondary p-6 text-primary-foreground">
                                <h2 class="font-display text-2xl font-bold">My Attendance</h2>
                                <p class="mt-2 text-primary-foreground/80">Track your placement training attendance</p>
                            </div>

                            <div class="p-6">
                                <!-- Student Info -->
                                <div class="mb-6 flex items-center gap-4">
                                    <div class="flex h-16 w-16 items-center justify-center rounded-lg bg-primary/10">
                                        <i data-lucide="user" class="h-8 w-8 text-primary"></i>
                                    </div>
                                    <div>
                                        <h3 class="font-display text-lg font-semibold" id="student-name">Loading...</h3>
                                        <p class="text-sm text-muted-foreground">Roll No: <span id="student-roll">Loading...</span></p>
                                    </div>
                                </div>

                                <!-- Barcode -->
                                <div class="mb-6 text-center">
                                    <p class="mb-2 text-sm font-medium">Student ID Barcode</p>
                                    <div class="inline-block bg-white p-4 rounded-lg border border-border">
                                        <svg id="barcode"></svg>
                                    </div>
                                </div>

                                <!-- Attendance Stats -->
                                <div class="grid grid-cols-2 gap-4 mb-6">
                                    <div class="rounded-lg bg-success/10 border border-success/20 p-4 text-center">
                                        <p class="text-2xl font-bold text-success" id="student-present">0</p>
                                        <p class="text-sm text-muted-foreground">Days Present</p>
                                    </div>
                                    <div class="rounded-lg bg-destructive/10 border border-destructive/20 p-4 text-center">
                                        <p class="text-2xl font-bold text-destructive" id="student-absent">0</p>
                                        <p class="text-sm text-muted-foreground">Days Absent</p>
                                    </div>
                                </div>

                                <!-- Attendance Percentage -->
                                <div class="mb-6">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-sm font-medium">Attendance Percentage</span>
                                        <span class="text-sm font-bold" id="attendance-percentage">0%</span>
                                    </div>
                                    <div class="w-full bg-muted rounded-full h-3">
                                        <div id="attendance-bar" class="bg-gradient-to-r from-success to-primary h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
                                    </div>
                                </div>

                                <!-- Leave Request -->
                                <div class="border-t border-border pt-6">
                                    <h3 class="mb-4 font-semibold">Request Leave</h3>
                                    <div class="space-y-4">
                                        <div>
                                            <label class="mb-2 block text-sm font-medium">Reason for Leave</label>
                                            <textarea id="leave-reason" rows="3" placeholder="Enter reason for leave..."
                                                class="flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"></textarea>
                                        </div>
                                        <button onclick="requestLeave()"
                                            class="w-full inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 bg-secondary text-secondary-foreground hover:bg-secondary/90">
                                            <i data-lucide="send" class="mr-2 h-4 w-4"></i>
                                            Submit Leave Request
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer injected via main.js -->

    <script src="assets/js/main.js"></script>
    <script src="assets/js/attendance.js"></script>
    <script>
        injectHeader();
        injectFooter();
    </script>
</body>

</html>